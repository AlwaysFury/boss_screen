<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.boss.client.dao.GradeDao">

<!--    itemId,tagList,categoryId,status,createTime-->
    <select id="getProduct" resultType="com.boss.client.dto.GradeObject">
        SELECT
            s.item_id as itemId,
            s.create_time as createTime,
            s.category_id as categoryId,
            s.status,
            t.id as tagIds
        FROM
            tb_produtc as s
            left JOIN tb_productorimg_tag as pt ON s.id = pt.itemOrImg_id and pt.tag_type = 'ITEM'
            left JOIN tb_tag as tt ON tt.id = pt.tag_id
        where
            s.status in ('NORMAL', 'UNLIST', 'REVIEWING')
    </select>

<!--    itemSku,tagList,createTime,price,salesVolume-->

    <resultMap id="photoResultMap" type="com.boss.client.dto.GradeObject">
        <result column="itemId" property="itemId"/>
        <result column="itemSku" property="itemSku"/>
        <result column="createTime" property="createTime"/>
        <result column="price" property="price"/>
        <result column="salesVolume" property="createTime"/>
        <collection property="tagIds" ofType="java.util.List">

        </collection>
    </resultMap>

    <select id="getSku" resultMap="photoResultMap">
        SELECT
            s.id as itemId,
            s.name as itemSku,
            min(m.create_time) as createTime,
            min(m.price) as price,
            sum(o.count) as salesVolume,
            t.id AS tagIds
        FROM
            tb_sku as s
        left join tb_model as m on s.name = m.sku_name
        left join tb_order_item as o on s.name = o.sku_name
        left JOIN tb_productorimg_tag as d ON s.id = d.itemOrImg_id  and d.tag_type = "PHOTO"
        left JOIN tb_tag as t ON t.id = d.tag_id
        where

    </select>

</mapper>
